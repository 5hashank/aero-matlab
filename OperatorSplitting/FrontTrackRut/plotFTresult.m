function plotFTresult(u,x,Periodic)%% A utility for plotting front tracking solutions, the components of u are% put in separate axes in the same figure. If there is only one component,% there will only be one axes.%%  plotFTresult(u,x,'Periodic');    %%  u : vector of size [ncomp,n] %  x : front positions, size n-1 if not periodic, else size n+1.%periodic=0;if (nargin>=3)	bndry=lower(Periodic);	periodic=strcmp(bndry,'periodic');end;[nc n]=size(u);figure(1); clf;dp=0.8/nc;dpp=0.05;for j=1:nc	yhigh=max(u(j,:)); ylow=min(u(j,:));	if ylow==yhigh,		ylow=yhigh-0.5;		yhigh=ylow+1;	end;	dy=0.05*(yhigh-ylow);	if periodic,		xlow=x(1);		xhigh=x(n-1);		dx=0.0;	else		if x(1)==x(n-1),			xlow=x(1)-0.5;			xhigh=xlow+1.0;		else			xhigh=x(n-1);			xlow=x(1);		end;		dx=0.025*(xhigh-xlow);	end;	axes('position',[0.1,dpp*(j-1)+0.05+(j-1)*dp,0.8,dp],...	      'XLim',[xlow-dx,xhigh+dx],'Ylim',[ylow-dy,yhigh+dy],'Box','on');	x1=xlow-dx;	if ~periodic,		line([x1,x(1)],[u(j,1),u(j,1)]);		line([x(1),x(1)],[u(j,1),u(j,2)]);		x1=x(1);		for i=2:n-1			line([x1,x(i)],[u(j,i),u(j,i)]);			x1=x(i);			if (i<n-1),				line([x1,x1],[u(j,i),u(j,i+1)]);			end;		end;		line([x1,x1],[u(j,n-1),u(j,n)]);		line([x(n-1) xhigh+dx],[u(j,n),u(j,n)]);	else		for i=2:n-2,			line([x1,x(i)],[u(j,i),u(j,i)]);			x1=x(i);			line([x1,x1],[u(j,i),u(j,i+1)]);		end;		line([x(n-2),x(n-1)],[u(j,n-1),u(j,n-1)]);	end;		end;