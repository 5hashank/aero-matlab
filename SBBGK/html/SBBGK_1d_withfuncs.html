
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>SBBGK_1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="SBBGK_1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">1D Semi-classical Boltzmann-BGK Equation</a></li><li><a href="#2">Simulation Parameters</a></li><li><a href="#3">Space Discretization</a></li><li><a href="#4">Define a ID name for results file</a></li><li><a href="#5">Open a Files to store the Results</a></li><li><a href="#6">Initial Conditions in physical Space</a></li><li><a href="#7">Microscopic Velocity Discretization (For DOM)</a></li><li><a href="#8">Applying Discrete Ordinate Method on ICs:</a></li><li><a href="#9">Marching Scheme</a></li><li><a href="#10">Close file with Results</a></li></ul><h2>Called Functions</h2><ul><li><a href="#GaussHermite">GaussHermite </a></li><li><a href="#cotes_xw">cotes_xw </a></li><li><a href="#ID_name">ID_name </a></li><li><a href="#SSBGK_IC1d">SSBGK_IC1d </a></li><li><a href="#apply_DOM">apply_DOM </a></li><li><a href="#f_ES_equilibrium_1d">f_ES_equilibrium_1d </a></li><li><a href="#f_equilibrium_1d">f_equilibrium_1d </a></li><li><a href="#macromoments1d">macromoments1d </a></li><li><a href="#macroproperties1d">macroproperties1d </a></li><li><a href="#TVDflux1d">TVDflux1d </a></li><li><a href="#Upwindflux1d">Upwindflux1d </a></li><li><a href="#fluxlimiter1d">fluxlimiter1d </a></li><li><a href="#theta1d">theta1d </a></li><li><a href="#WENO3_1d_BCs">WENO3_1d_BCs </a></li><li><a href="#WENO3_1d_driver">WENO3_1d_driver </a></li><li><a href="#WENO5_1d_driver">WENO5_1d_driver </a></li><li><a href="#WENO_scalarfluxsplit">WENO_scalarfluxsplit </a></li></ul></div><h2>1D Semi-classical Boltzmann-BGK Equation<a name="1"></a></h2><p>Numerical solution of the Boltzmann-BGK Equation to recover Euler macroscopic continuum solution. Coded by Manuel Diaz 2012.10.06</p><p>Semi-classical Boltzmann-BGK Transport Equation:</p><p><img src="SBBGK_1d_eq49006.png" alt="$$\frac{\partial f}{\partial t}+\vec F\cdot \nabla_p f + \vec v&#xA;\cdot\nabla_{\vec x} f =\widehat{\Omega } (f) = - \frac{f-f^{eq}}{\tau}$$"></p><pre class="codeinput">clear <span class="string">all</span>; close <span class="string">all</span>; <span class="comment">%clc;</span>
</pre><h2>Simulation Parameters<a name="2"></a></h2><pre class="codeinput">    name	=<span class="string">'SBBGK1d'</span>; <span class="comment">% Simulation Name</span>
    <span class="comment">%CFL    = 15/100;   % CFL condition &lt;- Part of IC's parameters</span>
    f_case  = 1;        <span class="comment">% {1} Relaxation Model, {2} Euler Limit</span>
    r_time  = 1/10000;  <span class="comment">% Relaxation time</span>
    <span class="comment">%tEnd  	= 0.05;     % End time &lt;- Part of IC's parameters</span>
    theta 	= 0;        <span class="comment">% {-1} BE, {0} MB, {1} FD.</span>
    fmodel  = 2;        <span class="comment">% {1} UU. model, {2} ES model.</span>
    quad   	= 2;        <span class="comment">% {1} 200NC , {2} 80GH</span>
    method 	= 3;        <span class="comment">% {1} Upwind, {2} TVD, {3} WENO3, {4} WENO5</span>
    IC_case	= 1;        <span class="comment">% IC: {1}~{14}. See Euler_IC1d.m</span>
  plot_figs = 0;        <span class="comment">% 0: no, 1: yes please!</span>
  write_ans = 1;        <span class="comment">% 0: no, 1: yes please!</span>
<span class="comment">% Using DG</span>
    P_deg	= 1;        <span class="comment">% Polinomial Degree</span>
    Pp      = P_deg+1;  <span class="comment">% Polinomials Points</span>
<span class="comment">% Using RK integration time step</span>
  RK_stages	= 1;        <span class="comment">% Number of RK stages</span>
</pre><h2>Space Discretization<a name="3"></a></h2><pre class="codeinput">nx  = 100;                      <span class="comment">% Desided number of points in our domain</span>
x   = linspace(0,1,nx);         <span class="comment">% Physical domain -x</span>
dx  = max(x(2:end)-x(1:end-1)); <span class="comment">% delta x</span>
</pre><h2>Define a ID name for results file<a name="4"></a></h2><pre class="codeinput">[ID, IDn] = ID_name(name,theta,nx,P_deg,RK_stages,r_time,IC_case,fmodel,f_case,method);
</pre><h2>Open a Files to store the Results<a name="5"></a></h2><pre class="codeinput"><span class="keyword">if</span> write_ans == 1
    file = fopen(IDn,<span class="string">'w'</span>);
    <span class="comment">% 'file' gets the handel for the file "case.plt".</span>
    <span class="comment">% 'w' specifies that it will be written.</span>
    <span class="comment">% similarly 'r' is for reading and 'a' for appending.</span>
    fprintf(file, <span class="string">'TITLE = "%s"\n'</span>,ID);
    fprintf(file, <span class="string">'VARIABLES = "x" "density" "velocity" "energy" "pressure" "temperature" "fugacity"\n'</span>);
<span class="keyword">end</span>
</pre><h2>Initial Conditions in physical Space<a name="6"></a></h2><p>Semiclassical ICs: Fugacity[z], Velocity[u] and Temperature[t]</p><pre class="codeinput">    [z0,u0,t0,p0,rho0,E0,tEnd,CFL] = SSBGK_IC1d(x,IC_case);
</pre><h2>Microscopic Velocity Discretization (For DOM)<a name="7"></a></h2><pre class="codeinput"><span class="keyword">switch</span> quad

    <span class="keyword">case</span>{1} <span class="comment">% Newton Cotes Quadrature:</span>
    V  = [-20,20];  <span class="comment">% range: a to b</span>
    nv = 200;       <span class="comment">% nodes desired (may not the actual value)</span>
    [v,w,k] = cotes_xw(V(1),V(2),nv,5); <span class="comment">% Using Netwon Cotes Degree 5</span>
    nv = length(v); <span class="comment">% actual number of discrete velocity points</span>
    v = repmat(v,1,nx);     w = repmat(w,1,nx);   <span class="comment">% using DOM</span>

    <span class="keyword">case</span>{2} <span class="comment">% Gauss Hermite Quadrature:</span>
    nv = 80;          <span class="comment">% nodes desired (the actual value)</span>
    [v,w] = GaussHermite(nv); <span class="comment">% for integrating range: -inf to inf</span>
    k = 1;            <span class="comment">% quadrature constant.</span>
    w = w.*exp(v.^2); <span class="comment">% weighting function of the Gauss-Hermite quadrature</span>
    nv = length(v); <span class="comment">% actual number of discrete velocity points</span>
    v = repmat(v,1,nx);     w = repmat(w,1,nx);   <span class="comment">% using DOM</span>

    <span class="keyword">otherwise</span>
        error(<span class="string">'Order must be between 1 and 2'</span>);
<span class="keyword">end</span>
</pre><h2>Applying Discrete Ordinate Method on ICs:<a name="8"></a></h2><pre class="codeinput">[z,ux,t] = apply_DOM(z0,u0,t0,nv);  <span class="comment">% Semi-classical IC</span>
[p,rho,E] = apply_DOM(p0,rho0,E0,nv); <span class="comment">% Classical IC</span>

<span class="comment">% Compute distribution IC of our mesoscopic method by assuming the equilibrium</span>
<span class="comment">% state of the macroscopic IC. Using the semiclassical Equilibrium</span>
<span class="comment">% distribuition function:</span>
<span class="keyword">switch</span> fmodel
    <span class="keyword">case</span>{1} <span class="comment">% U.U.</span>
        f0 = f_equilibrium_1d(z,ux,v,t,theta);
    <span class="keyword">case</span>{2} <span class="comment">% E.S.</span>
        f0 = f_ES_equilibrium_1d(z,p,rho,ux,v,t,theta);
    <span class="keyword">otherwise</span>
        error(<span class="string">'Order must be between 1 and 2'</span>);
<span class="keyword">end</span>

<span class="comment">% Plot IC of Distribution function, f, in Phase-Space:</span>
<span class="keyword">if</span> plot_figs == 1
   figure(1)
   surf(f0); grid <span class="string">on</span>; set(gca,<span class="string">'xDir'</span>,<span class="string">'reverse'</span>);
   xlabel(<span class="string">'x - Spatial Domain'</span>);
   ylabel(<span class="string">'v - Velocity Space'</span>);
   zlabel(<span class="string">'f - Probability'</span>);
<span class="keyword">end</span>
<span class="comment">% Compute Initial Macroscopic Momemts:</span>
    <span class="comment">%[rho,rhoux,E,ne,Wxx] = macromoments1d(k,w,f0,v,ux); %Just for testing</span>
    <span class="comment">%[~,~,~,p] = macroproperties1d(rho,rhoux,E,ne,Wxx,nx,theta,fmodel);</span>
</pre><h2>Marching Scheme<a name="9"></a></h2><p>First we need to define how big is our time step. Due to the discrete ordinate method the problem is similar to evolve the same problem for every mesoscopic velocity.</p><pre class="codeinput">dt = dx*CFL/max(abs(v(:,1)));
dtdx = dt/dx;  <span class="comment">% precomputed to save someflops</span>

<span class="comment">% Time domain discretization</span>
time = 0:dt:tEnd;

<span class="comment">% By negleting any force field acting over our domian, the classic</span>
<span class="comment">% transport Boltzmann equation will resemble to a pure advection equation.</span>
<span class="comment">% Thus WENO, TVD, DG or CPR can be used easyly to compute evolution of the</span>
<span class="comment">% information inside the domain:</span>
tic
<span class="keyword">switch</span> method

    <span class="keyword">case</span>{1} <span class="comment">% Upwind 0(h)</span>
        <span class="comment">% Load IC</span>
        f = f0;

        <span class="keyword">for</span> tsteps = time
            <span class="comment">% Update scalar speed</span>
            a = v(:,1);

            <span class="comment">% Plot and redraw figures every time step for visualization</span>
            <span class="keyword">if</span> plot_figs == 1
            <span class="comment">% Plot f distribution</span>
            figure(1)
            surf(f); grid <span class="string">on</span>; set(gca,<span class="string">'xDir'</span>,<span class="string">'reverse'</span>);
            xlabel(<span class="string">'x - Spatial Domain'</span>);
            ylabel(<span class="string">'v - Velocity Space'</span>);
            zlabel(<span class="string">'f - Probability'</span>);
            <span class="comment">% Plot Macroscopic variables</span>
            figure(2)
            subplot(2,3,1); plot(x,rho(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Density'</span>)
            subplot(2,3,2); plot(x,ux(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'x-Velocity'</span>)
            subplot(2,3,3); plot(x,p(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Pressure'</span>)
            subplot(2,3,4); plot(x,z(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Fugacity'</span>)
            subplot(2,3,5); plot(x,t(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Temperature'</span>)
            subplot(2,3,6); plot(x,E(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Energy'</span>)
            <span class="keyword">end</span>
            <span class="comment">% Write Results</span>
            <span class="keyword">if</span> write_ans == 1 &amp;&amp; (mod(tsteps,5*dt) == 0 || tsteps == time(end))
                fprintf(file, <span class="string">'ZONE T = "time %0.4f"\n'</span>, tsteps);
                fprintf(file, <span class="string">'I = %d, J = 1, K = 1, F = POINT\n\n'</span>, nx);
                <span class="keyword">for</span> i = 1:nx
                    fprintf(file, <span class="string">'%f\t%f\t%f\t%f\t%f\t%f\t%f\t\n'</span>, <span class="keyword">...</span>
                        x(1,i),rho(1,i),ux(1,i),E(1,i),p(1,i),t(1,i),z(1,i));
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="comment">% Compute equilibrium distribution for the current t_step</span>
            <span class="keyword">switch</span> fmodel
                <span class="keyword">case</span>{1} <span class="comment">% U.U.</span>
                    f_eq = f_equilibrium_1d(z,ux,v,t,theta);
                <span class="keyword">case</span>{2} <span class="comment">% E.S.</span>
                    f_eq = f_ES_equilibrium_1d(z,p,rho,ux,v,t,theta);
                <span class="keyword">otherwise</span>
                    error(<span class="string">'Order must be between 1 and 2'</span>);
            <span class="keyword">end</span>

            <span class="comment">% initialize variables</span>
            u_eq = zeros(1,nx);
            u = zeros(1,nx);

            <span class="comment">% (this part can, and should be done in parallel!)</span>
            <span class="keyword">for</span> i = 1:nv
                <span class="comment">% load subcase</span>
                <span class="keyword">switch</span> f_case
                    <span class="keyword">case</span>{1} <span class="comment">% Relaxation Scheme</span>
                        u_eq(:) = f_eq(i,:);
                        u(:) = f(i,:);
                    <span class="keyword">case</span>{2} <span class="comment">% Euler Limit</span>
                        u_eq(:) = f_eq(i,:);
                        u(:) = f_eq(i,:);
                <span class="keyword">end</span>

                <span class="comment">% Compute TVD Fluxes</span>
                [F_left,F_right] = Upwindflux1d(u,a(i,:));

                <span class="comment">% Compute next time step</span>
                u_next = u - dtdx*(F_right - F_left) <span class="keyword">...</span>
                    + (dt/r_time)*(u_eq-u);

                <span class="comment">% BC</span>
                u_next(1) = u_next(2);
                u_next(nx) = u_next(nx-1);

                <span class="comment">% UPDATE info</span>
                u = u_next;

                <span class="comment">% Going back to f</span>
                f(i,:) = u(:);
            <span class="keyword">end</span>

            <span class="comment">% Compute macroscopic moments</span>
            [rho,rhoux,E,ne,Wxx] = macromoments1d(k,w,f,v,ux);

            <span class="comment">% UPDATE macroscopic properties</span>
            <span class="keyword">try</span>
            <span class="comment">% (here lies a paralellizing computing challenge)</span>
            [z,ux,t,p] = macroproperties1d(rho,rhoux,E,ne,Wxx,nx,theta,fmodel);
            <span class="keyword">catch</span> ME
                ME <span class="comment">%#ok&lt;NOPTS&gt; % show error message</span>
                <span class="keyword">break</span>
            <span class="keyword">end</span>

            <span class="comment">% Apply DOM</span>
            [z,ux,t] = apply_DOM(z,ux,t,nv); <span class="comment">% Semi-classical variables</span>
            <span class="comment">%[p,rho,E] = apply_DOM(p,rho,E,nv); % Classical variables</span>

            <span class="comment">% Update figures</span>
            drawnow
        <span class="keyword">end</span>

    <span class="keyword">case</span>{2} <span class="comment">% TVD 0(h^2)</span>
        <span class="comment">% Load IC</span>
        f = f0;

        <span class="keyword">for</span> tsteps = time
            <span class="comment">% Update velocity coeficients</span>
            a = v(:,1);

            <span class="comment">% Plot and redraw figures every time step for visualization</span>
            <span class="keyword">if</span> plot_figs == 1
            <span class="comment">% Plot f distribution</span>
            figure(1)
            surf(f); grid <span class="string">on</span>; set(gca,<span class="string">'xDir'</span>,<span class="string">'reverse'</span>);
            xlabel(<span class="string">'x - Spatial Domain'</span>);
            ylabel(<span class="string">'v - Velocity Space'</span>);
            zlabel(<span class="string">'f - Probability'</span>);
            <span class="comment">% Plot Macroscopic variables</span>
            figure(2)
            subplot(2,3,1); plot(x,rho(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Density'</span>)
            subplot(2,3,2); plot(x,ux(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'x-Velocity'</span>)
            subplot(2,3,3); plot(x,p(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Pressure'</span>)
            subplot(2,3,4); plot(x,z(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Fugacity'</span>)
            subplot(2,3,5); plot(x,t(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Temperature'</span>)
            subplot(2,3,6); plot(x,E(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Energy'</span>)
            <span class="keyword">end</span>
            <span class="comment">% Write Results</span>
            <span class="keyword">if</span> write_ans == 1 &amp;&amp; (mod(tsteps,5*dt) == 0 || tsteps == time(end))
                fprintf(file, <span class="string">'ZONE T = "time %0.4f"\n'</span>, tsteps);
                fprintf(file, <span class="string">'I = %d, J = 1, K = 1, F = POINT\n\n'</span>, nx);
                <span class="keyword">for</span> i = 1:nx
                    fprintf(file, <span class="string">'%f\t%f\t%f\t%f\t%f\t%f\t%f\t\n'</span>, <span class="keyword">...</span>
                        x(1,i),rho(1,i),ux(1,i),E(1,i),p(1,i),t(1,i),z(1,i));
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="comment">% Compute equilibrium distribution for the current t_step</span>
            <span class="keyword">switch</span> fmodel
                <span class="keyword">case</span>{1} <span class="comment">% U.U.</span>
                    f_eq = f_equilibrium_1d(z,ux,v,t,theta);
                <span class="keyword">case</span>{2} <span class="comment">% E.S.</span>
                    f_eq = f_ES_equilibrium_1d(z,p,rho,ux,v,t,theta);
                <span class="keyword">otherwise</span>
                    error(<span class="string">'Order must be between 1 and 2'</span>);
            <span class="keyword">end</span>

            <span class="comment">% initialize variables</span>
            u_eq = zeros(1,nx);
            u = zeros(1,nx);

            <span class="comment">% (this part can, and should be done in parallel!)</span>
            <span class="keyword">for</span> i = 1:nv
                <span class="comment">% Load subcase</span>
                <span class="keyword">switch</span> f_case
                    <span class="keyword">case</span>{1} <span class="comment">% Relaxation Scheme</span>
                        u_eq(:) = f_eq(i,:);
                        u(:) = f(i,:);
                    <span class="keyword">case</span>{2} <span class="comment">% Euler Limit</span>
                        u_eq(:) = f_eq(i,:);
                        u(:) = f_eq(i,:);
                <span class="keyword">end</span>

                <span class="comment">% Compute the smoothness factors, r(j), from data, u(j).</span>
                [r] = theta1d(u,a(i));

                <span class="comment">% Compute the Flux Limiter</span>
                [phi] = fluxlimiter1d(r,1); <span class="comment">% using limiter = 1</span>

                <span class="comment">% Compute TVD Fluxes</span>
                [F_left,F_right] = TVDflux1d(u,a(i),dtdx,phi);

                <span class="comment">% Compute next time step</span>
                u_next = u - dtdx*(F_right - F_left) <span class="keyword">...</span>
                    + (dt/r_time)*(u_eq-u);

                <span class="comment">% BC</span>
                u_next(1) = u_next(2);
                u_next(nx) = u_next(nx-1);

                <span class="comment">% UPDATE info</span>
                u = u_next;

                <span class="comment">% Going back to f</span>
                f(i,:) = u(:);
            <span class="keyword">end</span>

            <span class="comment">% Compute macroscopic moments</span>
            [rho,rhoux,E,ne,Wxx] = macromoments1d(k,w,f,v,ux);

            <span class="comment">% UPDATE macroscopic properties</span>
            <span class="keyword">try</span>
            <span class="comment">% (here lies a paralellizing computing challenge)</span>
            [z,ux,t,p] = macroproperties1d(rho,rhoux,E,ne,Wxx,nx,theta,fmodel);
            <span class="keyword">catch</span> ME
                ME <span class="comment">%#ok&lt;NOPTS&gt; % show error message</span>
                <span class="keyword">break</span>
            <span class="keyword">end</span>

            <span class="comment">% Apply DOM</span>
            [z,ux,t] = apply_DOM(z,ux,t,nv); <span class="comment">% Semi-classical variables</span>
            <span class="comment">%[p,rho,E] = apply_DOM(p,rho,E,nv); % Classical variables</span>

            <span class="comment">% Update figures</span>
            drawnow
        <span class="keyword">end</span>

    <span class="keyword">case</span>{3,4} <span class="comment">% WENO(r = 2)3, 0(h^5) &amp; WENO(r = 3)5, 0(h^9)</span>
        <span class="comment">% Load initial condition</span>
        f = f0;

        <span class="keyword">for</span> tsteps = time
            <span class="comment">% Update scalar velocity</span>
            a = v(:,1);

            <span class="comment">% Plot and redraw figures every time step for visualization</span>
            <span class="keyword">if</span> plot_figs == 1
            <span class="comment">% Plot evolution of 'f' distribution function</span>
            figure(1)
            surf(f); grid <span class="string">on</span>; set(gca,<span class="string">'xDir'</span>,<span class="string">'reverse'</span>);
            xlabel(<span class="string">'x - Spatial Domain'</span>);
            ylabel(<span class="string">'v - Velocity Space'</span>);
            zlabel(<span class="string">'f - Probability'</span>);
            <span class="comment">% Plot Macroscopic variables</span>
            figure(2)
            subplot(2,3,1); plot(x,rho(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Density'</span>)
            subplot(2,3,2); plot(x,ux(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'x-Velocity'</span>)
            subplot(2,3,3); plot(x,p(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Pressure'</span>)
            subplot(2,3,4); plot(x,z(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Fugacity'</span>)
            subplot(2,3,5); plot(x,t(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Temperature'</span>)
            subplot(2,3,6); plot(x,E(1,:),<span class="string">'.'</span>); axis <span class="string">tight</span>; title(<span class="string">'Energy'</span>)
            <span class="keyword">end</span>
            <span class="comment">% Write Results</span>
            <span class="keyword">if</span> write_ans == 1 &amp;&amp; (mod(tsteps,5*dt) == 0 || tsteps == time(end))
                fprintf(file, <span class="string">'ZONE T = "time %0.4f"\n'</span>, tsteps);
                fprintf(file, <span class="string">'I = %d, J = 1, K = 1, F = POINT\n\n'</span>, nx);
                <span class="keyword">for</span> i = 1:nx
                    fprintf(file, <span class="string">'%f\t%f\t%f\t%f\t%f\t%f\t%f\t\n'</span>, <span class="keyword">...</span>
                        x(1,i),rho(1,i),ux(1,i),E(1,i),p(1,i),t(1,i),z(1,i));
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="comment">% Compute equilibrium distribution for the current t_step</span>
            <span class="keyword">switch</span> fmodel
                <span class="keyword">case</span>{1} <span class="comment">% U.U.</span>
                    f_eq = f_equilibrium_1d(z,ux,v,t,theta);
                <span class="keyword">case</span>{2} <span class="comment">% E.S.</span>
                    f_eq = f_ES_equilibrium_1d(z,p,rho,ux,v,t,theta);
                <span class="keyword">otherwise</span>
                    error(<span class="string">'Order must be between 1 and 2'</span>);
            <span class="keyword">end</span>

            <span class="comment">% initialize variables</span>
            u_eq = zeros(1,nx);
            u = zeros(1,nx);

            <span class="comment">% (this part can, and should be done in parallel!)</span>
            <span class="keyword">for</span> i = 1:nv
                <span class="comment">% Load subcase</span>
                <span class="keyword">switch</span> f_case
                    <span class="keyword">case</span>{1} <span class="comment">% Relaxation Scheme</span>
                        u_eq(:) = f_eq(i,:);
                        u(:) = f(i,:);
                    <span class="keyword">case</span>{2} <span class="comment">% Euler Limit</span>
                        u_eq(:) = f_eq(i,:);
                        u(:) = f_eq(i,:);
                <span class="keyword">end</span>

                <span class="comment">% Scalar Flux Spliting</span>
                [vp,vn] = WENO_scalarfluxsplit(a(i)*u);

                <span class="comment">% Reconstruct Fluxes values at cells interfaces</span>
                <span class="keyword">switch</span> method
                    <span class="keyword">case</span>(3) <span class="comment">% WENO3</span>
                        [F_left,F_right] = WENO3_1d_driver(vp,vn);
                    <span class="keyword">case</span>{4} <span class="comment">% WENO5</span>
                        [F_left,F_right] = WENO5_1d_driver(vp,vn);
                <span class="keyword">end</span>

                <span class="comment">% Compute next time step</span>
                u_next = u - dtdx*(F_right - F_left) <span class="keyword">...</span>
                    + (dt/r_time)*(u_eq-u);

                <span class="comment">% BC</span>
                u_next = WENO3_1d_BCs(u_next,2,nx); <span class="comment">%2:Neumann BC</span>

                <span class="comment">% UPDATE info</span>
                u = u_next;

                <span class="comment">% Going back to f</span>
                f(i,:) = u(:);
            <span class="keyword">end</span>

            <span class="comment">% Compute macroscopic moments</span>
            [rho,rhoux,E,ne,Wxx] = macromoments1d(k,w,f,v,ux);

            <span class="comment">% UPDATE macroscopic properties</span>
            <span class="keyword">try</span>
            <span class="comment">% (here lies a paralellizing computing challenge)</span>
            [z,ux,t,p] = macroproperties1d(rho,rhoux,E,ne,Wxx,nx,theta,fmodel);
            <span class="keyword">catch</span> ME
                ME <span class="comment">%#ok&lt;NOPTS&gt; % show error message</span>
                <span class="keyword">break</span>
            <span class="keyword">end</span>

            <span class="comment">% Apply DOM</span>
            [z,ux,t] = apply_DOM(z,ux,t,nv); <span class="comment">% Semi-classical variables</span>
            <span class="comment">%[p,rho,E] = apply_DOM(p,rho,E,nv); % Classical variables</span>

            <span class="comment">% Update figures</span>
            drawnow
        <span class="keyword">end</span>

    <span class="keyword">otherwise</span>
        error(<span class="string">'Method must be between 1, 2 and 3'</span>);
<span class="keyword">end</span>
toc
</pre><h2>Close file with Results<a name="10"></a></h2><pre class="codeinput">fprintf(<span class="string">'Simulation has been completed succesfully!\n'</span>)
<span class="keyword">if</span> write_ans == 1
    fclose(file);
    fprintf(<span class="string">'All Results have been saved!\n'</span>)
<span class="keyword">end</span>

<span class="keyword">if</span> plot_figs ~= 1
    <span class="comment">% Plot Macroscopic variables</span>
    figure(2)
    subplot(2,3,1); plot(x,rho(1,:),<span class="string">'o'</span>); axis <span class="string">tight</span>; title(<span class="string">'Density'</span>)
    subplot(2,3,2); plot(x,ux(1,:),<span class="string">'o'</span>); axis <span class="string">tight</span>; title(<span class="string">'x-Velocity'</span>)
    subplot(2,3,3); plot(x,p(1,:),<span class="string">'o'</span>); axis <span class="string">tight</span>; title(<span class="string">'Pressure'</span>)
    subplot(2,3,4); plot(x,z(1,:),<span class="string">'o'</span>); axis <span class="string">tight</span>; title(<span class="string">'Fugacity'</span>)
    subplot(2,3,5); plot(x,t(1,:),<span class="string">'o'</span>); axis <span class="string">tight</span>; title(<span class="string">'Temperature'</span>)
    subplot(2,3,6); plot(x,E(1,:),<span class="string">'o'</span>); axis <span class="string">tight</span>; title(<span class="string">'Energy'</span>)
<span class="keyword">end</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
##### SOURCE BEGIN #####
%% 1D Semi-classical Boltzmann-BGK Equation
% Numerical solution of the Boltzmann-BGK Equation to recover Euler macroscopic
% continuum solution. Coded by Manuel Diaz 2012.10.06
%
% Semi-classical Boltzmann-BGK Transport Equation:
%
% $$\frac{\partial f}{\partial t}+\vec F\cdot \nabla_p f + \vec v
% \cdot\nabla_{\vec x} f =\widehat{\Omega } (f) = - \frac{f-f^{eq}}{\tau}$$
%
clear all; close all; %clc;

%% Simulation Parameters
    name	='SBBGK1d'; % Simulation Name
    %CFL    = 15/100;   % CFL condition <- Part of IC's parameters
    f_case  = 1;        % {1} Relaxation Model, {2} Euler Limit
    r_time  = 1/10000;  % Relaxation time
    %tEnd  	= 0.05;     % End time <- Part of IC's parameters
    theta 	= 0;        % {-1} BE, {0} MB, {1} FD.
    fmodel  = 2;        % {1} UU. model, {2} ES model.
    quad   	= 2;        % {1} 200NC , {2} 80GH
    method 	= 3;        % {1} Upwind, {2} TVD, {3} WENO3, {4} WENO5
    IC_case	= 1;        % IC: {1}~{14}. See Euler_IC1d.m
  plot_figs = 0;        % 0: no, 1: yes please!
  write_ans = 1;        % 0: no, 1: yes please!
% Using DG
    P_deg	= 1;        % Polinomial Degree
    Pp      = P_deg+1;  % Polinomials Points
% Using RK integration time step
  RK_stages	= 1;        % Number of RK stages

%% Space Discretization
nx  = 100;                      % Desided number of points in our domain
x   = linspace(0,1,nx);         % Physical domain -x
dx  = max(x(2:end)-x(1:end-1)); % delta x

%% Define a ID name for results file
[ID, IDn] = ID_name(name,theta,nx,P_deg,RK_stages,r_time,IC_case,fmodel,f_case,method);

%% Open a Files to store the Results
if write_ans == 1
    file = fopen(IDn,'w');
    % 'file' gets the handel for the file "case.plt".
    % 'w' specifies that it will be written.
    % similarly 'r' is for reading and 'a' for appending.
    fprintf(file, 'TITLE = "%s"\n',ID);
    fprintf(file, 'VARIABLES = "x" "density" "velocity" "energy" "pressure" "temperature" "fugacity"\n');
end

%% Initial Conditions in physical Space
% Semiclassical ICs: Fugacity[z], Velocity[u] and Temperature[t] 
    [z0,u0,t0,p0,rho0,E0,tEnd,CFL] = SSBGK_IC1d(x,IC_case);

%% Microscopic Velocity Discretization (For DOM)
switch quad

    case{1} % Newton Cotes Quadrature:
    V  = [-20,20];  % range: a to b
    nv = 200;       % nodes desired (may not the actual value)
    [v,w,k] = cotes_xw(V(1),V(2),nv,5); % Using Netwon Cotes Degree 5
    nv = length(v); % actual number of discrete velocity points
    v = repmat(v,1,nx);     w = repmat(w,1,nx);   % using DOM
    
    case{2} % Gauss Hermite Quadrature:
    nv = 80;          % nodes desired (the actual value)
    [v,w] = GaussHermite(nv); % for integrating range: -inf to inf
    k = 1;            % quadrature constant.
    w = w.*exp(v.^2); % weighting function of the Gauss-Hermite quadrature
    nv = length(v); % actual number of discrete velocity points
    v = repmat(v,1,nx);     w = repmat(w,1,nx);   % using DOM
    
    otherwise
        error('Order must be between 1 and 2');
end

%% Applying Discrete Ordinate Method on ICs:
[z,ux,t] = apply_DOM(z0,u0,t0,nv);  % Semi-classical IC
[p,rho,E] = apply_DOM(p0,rho0,E0,nv); % Classical IC

% Compute distribution IC of our mesoscopic method by assuming the equilibrium 
% state of the macroscopic IC. Using the semiclassical Equilibrium
% distribuition function:
switch fmodel
    case{1} % U.U.
        f0 = f_equilibrium_1d(z,ux,v,t,theta);
    case{2} % E.S.
        f0 = f_ES_equilibrium_1d(z,p,rho,ux,v,t,theta);
    otherwise
        error('Order must be between 1 and 2');
end
    
% Plot IC of Distribution function, f, in Phase-Space:
if plot_figs == 1
   figure(1)
   surf(f0); grid on; set(gca,'xDir','reverse');
   xlabel('x - Spatial Domain'); 
   ylabel('v - Velocity Space');
   zlabel('f - Probability');
end
% Compute Initial Macroscopic Momemts:
    %[rho,rhoux,E,ne,Wxx] = macromoments1d(k,w,f0,v,ux); %Just for testing
    %[~,~,~,p] = macroproperties1d(rho,rhoux,E,ne,Wxx,nx,theta,fmodel);
    
%% Marching Scheme
% First we need to define how big is our time step. Due to the discrete
% ordinate method the problem is similar to evolve the same problem for
% every mesoscopic velocity.
dt = dx*CFL/max(abs(v(:,1))); 
dtdx = dt/dx;  % precomputed to save someflops

% Time domain discretization
time = 0:dt:tEnd;

% By negleting any force field acting over our domian, the classic
% transport Boltzmann equation will resemble to a pure advection equation.
% Thus WENO, TVD, DG or CPR can be used easyly to compute evolution of the
% information inside the domain: 
tic
switch method
    
    case{1} % Upwind 0(h)
        % Load IC
        f = f0;
                        
        for tsteps = time
            % Update scalar speed
            a = v(:,1);
            
            % Plot and redraw figures every time step for visualization
            if plot_figs == 1
            % Plot f distribution
            figure(1)
            surf(f); grid on; set(gca,'xDir','reverse');
            xlabel('x - Spatial Domain');
            ylabel('v - Velocity Space');
            zlabel('f - Probability');
            % Plot Macroscopic variables
            figure(2)
            subplot(2,3,1); plot(x,rho(1,:),'.'); axis tight; title('Density')
            subplot(2,3,2); plot(x,ux(1,:),'.'); axis tight; title('x-Velocity')
            subplot(2,3,3); plot(x,p(1,:),'.'); axis tight; title('Pressure')
            subplot(2,3,4); plot(x,z(1,:),'.'); axis tight; title('Fugacity')
            subplot(2,3,5); plot(x,t(1,:),'.'); axis tight; title('Temperature')
            subplot(2,3,6); plot(x,E(1,:),'.'); axis tight; title('Energy')
            end
            % Write Results
            if write_ans == 1 && (mod(tsteps,5*dt) == 0 || tsteps == time(end))
                fprintf(file, 'ZONE T = "time %0.4f"\n', tsteps);
                fprintf(file, 'I = %d, J = 1, K = 1, F = POINT\n\n', nx);
                for i = 1:nx
                    fprintf(file, '%f\t%f\t%f\t%f\t%f\t%f\t%f\t\n', ...
                        x(1,i),rho(1,i),ux(1,i),E(1,i),p(1,i),t(1,i),z(1,i));
                end
            end
            
            % Compute equilibrium distribution for the current t_step
            switch fmodel
                case{1} % U.U.
                    f_eq = f_equilibrium_1d(z,ux,v,t,theta);
                case{2} % E.S.
                    f_eq = f_ES_equilibrium_1d(z,p,rho,ux,v,t,theta);
                otherwise
                    error('Order must be between 1 and 2');
            end
                                    
            % initialize variables
            u_eq = zeros(1,nx);
            u = zeros(1,nx);
                              
            % (this part can, and should be done in parallel!)
            for i = 1:nv
                % load subcase
                switch f_case
                    case{1} % Relaxation Scheme
                        u_eq(:) = f_eq(i,:);
                        u(:) = f(i,:);
                    case{2} % Euler Limit
                        u_eq(:) = f_eq(i,:);
                        u(:) = f_eq(i,:);
                end
                
                % Compute TVD Fluxes
                [F_left,F_right] = Upwindflux1d(u,a(i,:));

                % Compute next time step
                u_next = u - dtdx*(F_right - F_left) ...
                    + (dt/r_time)*(u_eq-u);

                % BC
                u_next(1) = u_next(2);
                u_next(nx) = u_next(nx-1);

                % UPDATE info
                u = u_next;
                
                % Going back to f
                f(i,:) = u(:);
            end
            
            % Compute macroscopic moments
            [rho,rhoux,E,ne,Wxx] = macromoments1d(k,w,f,v,ux);
            
            % UPDATE macroscopic properties 
            try
            % (here lies a paralellizing computing challenge)
            [z,ux,t,p] = macroproperties1d(rho,rhoux,E,ne,Wxx,nx,theta,fmodel);
            catch ME
                ME %#ok<NOPTS> % show error message
                break
            end
            
            % Apply DOM
            [z,ux,t] = apply_DOM(z,ux,t,nv); % Semi-classical variables
            %[p,rho,E] = apply_DOM(p,rho,E,nv); % Classical variables
            
            % Update figures
            drawnow
        end
    
    case{2} % TVD 0(h^2)
        % Load IC
        f = f0;
                        
        for tsteps = time
            % Update velocity coeficients
            a = v(:,1);
            
            % Plot and redraw figures every time step for visualization
            if plot_figs == 1
            % Plot f distribution
            figure(1)
            surf(f); grid on; set(gca,'xDir','reverse');
            xlabel('x - Spatial Domain');
            ylabel('v - Velocity Space');
            zlabel('f - Probability');
            % Plot Macroscopic variables
            figure(2)
            subplot(2,3,1); plot(x,rho(1,:),'.'); axis tight; title('Density')
            subplot(2,3,2); plot(x,ux(1,:),'.'); axis tight; title('x-Velocity')
            subplot(2,3,3); plot(x,p(1,:),'.'); axis tight; title('Pressure')
            subplot(2,3,4); plot(x,z(1,:),'.'); axis tight; title('Fugacity')
            subplot(2,3,5); plot(x,t(1,:),'.'); axis tight; title('Temperature')
            subplot(2,3,6); plot(x,E(1,:),'.'); axis tight; title('Energy')
            end
            % Write Results
            if write_ans == 1 && (mod(tsteps,5*dt) == 0 || tsteps == time(end))
                fprintf(file, 'ZONE T = "time %0.4f"\n', tsteps);
                fprintf(file, 'I = %d, J = 1, K = 1, F = POINT\n\n', nx);
                for i = 1:nx
                    fprintf(file, '%f\t%f\t%f\t%f\t%f\t%f\t%f\t\n', ...
                        x(1,i),rho(1,i),ux(1,i),E(1,i),p(1,i),t(1,i),z(1,i));
                end
            end
            
            % Compute equilibrium distribution for the current t_step
            switch fmodel
                case{1} % U.U.
                    f_eq = f_equilibrium_1d(z,ux,v,t,theta);
                case{2} % E.S.
                    f_eq = f_ES_equilibrium_1d(z,p,rho,ux,v,t,theta);
                otherwise
                    error('Order must be between 1 and 2');
            end
                        
            % initialize variables
            u_eq = zeros(1,nx);
            u = zeros(1,nx);
                              
            % (this part can, and should be done in parallel!)
            for i = 1:nv
                % Load subcase
                switch f_case
                    case{1} % Relaxation Scheme
                        u_eq(:) = f_eq(i,:);
                        u(:) = f(i,:);
                    case{2} % Euler Limit
                        u_eq(:) = f_eq(i,:);
                        u(:) = f_eq(i,:);
                end
                
                % Compute the smoothness factors, r(j), from data, u(j).
                [r] = theta1d(u,a(i));

                % Compute the Flux Limiter
                [phi] = fluxlimiter1d(r,1); % using limiter = 1

                % Compute TVD Fluxes
                [F_left,F_right] = TVDflux1d(u,a(i),dtdx,phi);

                % Compute next time step
                u_next = u - dtdx*(F_right - F_left) ...
                    + (dt/r_time)*(u_eq-u);

                % BC
                u_next(1) = u_next(2);
                u_next(nx) = u_next(nx-1);

                % UPDATE info
                u = u_next;
                
                % Going back to f
                f(i,:) = u(:);
            end
            
            % Compute macroscopic moments
            [rho,rhoux,E,ne,Wxx] = macromoments1d(k,w,f,v,ux);
            
            % UPDATE macroscopic properties 
            try
            % (here lies a paralellizing computing challenge)
            [z,ux,t,p] = macroproperties1d(rho,rhoux,E,ne,Wxx,nx,theta,fmodel);
            catch ME
                ME %#ok<NOPTS> % show error message
                break
            end
            
            % Apply DOM
            [z,ux,t] = apply_DOM(z,ux,t,nv); % Semi-classical variables
            %[p,rho,E] = apply_DOM(p,rho,E,nv); % Classical variables
            
            % Update figures
            drawnow
        end
        
    case{3,4} % WENO(r = 2)3, 0(h^5) & WENO(r = 3)5, 0(h^9)
        % Load initial condition
        f = f0;
                        
        for tsteps = time
            % Update scalar velocity
            a = v(:,1);
            
            % Plot and redraw figures every time step for visualization
            if plot_figs == 1
            % Plot evolution of 'f' distribution function
            figure(1)
            surf(f); grid on; set(gca,'xDir','reverse');
            xlabel('x - Spatial Domain');
            ylabel('v - Velocity Space');
            zlabel('f - Probability');
            % Plot Macroscopic variables
            figure(2)
            subplot(2,3,1); plot(x,rho(1,:),'.'); axis tight; title('Density')
            subplot(2,3,2); plot(x,ux(1,:),'.'); axis tight; title('x-Velocity')
            subplot(2,3,3); plot(x,p(1,:),'.'); axis tight; title('Pressure')
            subplot(2,3,4); plot(x,z(1,:),'.'); axis tight; title('Fugacity')
            subplot(2,3,5); plot(x,t(1,:),'.'); axis tight; title('Temperature')
            subplot(2,3,6); plot(x,E(1,:),'.'); axis tight; title('Energy')
            end
            % Write Results
            if write_ans == 1 && (mod(tsteps,5*dt) == 0 || tsteps == time(end))
                fprintf(file, 'ZONE T = "time %0.4f"\n', tsteps);
                fprintf(file, 'I = %d, J = 1, K = 1, F = POINT\n\n', nx);
                for i = 1:nx
                    fprintf(file, '%f\t%f\t%f\t%f\t%f\t%f\t%f\t\n', ...
                        x(1,i),rho(1,i),ux(1,i),E(1,i),p(1,i),t(1,i),z(1,i));
                end
            end
            
            % Compute equilibrium distribution for the current t_step
            switch fmodel
                case{1} % U.U.
                    f_eq = f_equilibrium_1d(z,ux,v,t,theta);
                case{2} % E.S.
                    f_eq = f_ES_equilibrium_1d(z,p,rho,ux,v,t,theta);
                otherwise
                    error('Order must be between 1 and 2');
            end
                        
            % initialize variables
            u_eq = zeros(1,nx);
            u = zeros(1,nx);
                              
            % (this part can, and should be done in parallel!)
            for i = 1:nv
                % Load subcase
                switch f_case
                    case{1} % Relaxation Scheme
                        u_eq(:) = f_eq(i,:);
                        u(:) = f(i,:);
                    case{2} % Euler Limit
                        u_eq(:) = f_eq(i,:);
                        u(:) = f_eq(i,:);
                end
                
                % Scalar Flux Spliting
                [vp,vn] = WENO_scalarfluxsplit(a(i)*u);
                
                % Reconstruct Fluxes values at cells interfaces
                switch method
                    case(3) % WENO3
                        [F_left,F_right] = WENO3_1d_driver(vp,vn);
                    case{4} % WENO5
                        [F_left,F_right] = WENO5_1d_driver(vp,vn);
                end
                
                % Compute next time step
                u_next = u - dtdx*(F_right - F_left) ...
                    + (dt/r_time)*(u_eq-u);
                
                % BC
                u_next = WENO3_1d_BCs(u_next,2,nx); %2:Neumann BC

                % UPDATE info
                u = u_next;
                
                % Going back to f
                f(i,:) = u(:);
            end
            
            % Compute macroscopic moments
            [rho,rhoux,E,ne,Wxx] = macromoments1d(k,w,f,v,ux);
            
            % UPDATE macroscopic properties 
            try
            % (here lies a paralellizing computing challenge)
            [z,ux,t,p] = macroproperties1d(rho,rhoux,E,ne,Wxx,nx,theta,fmodel);
            catch ME
                ME %#ok<NOPTS> % show error message
                break
            end
                    
            % Apply DOM
            [z,ux,t] = apply_DOM(z,ux,t,nv); % Semi-classical variables
            %[p,rho,E] = apply_DOM(p,rho,E,nv); % Classical variables
            
            % Update figures
            drawnow
        end
        
    otherwise
        error('Method must be between 1, 2 and 3');
end
toc
%% Close file with Results
fprintf('Simulation has been completed succesfully!\n')
if write_ans == 1
    fclose(file);
    fprintf('All Results have been saved!\n')
end

if plot_figs ~= 1
    % Plot Macroscopic variables
    figure(2)
    subplot(2,3,1); plot(x,rho(1,:),'o'); axis tight; title('Density')
    subplot(2,3,2); plot(x,ux(1,:),'o'); axis tight; title('x-Velocity')
    subplot(2,3,3); plot(x,p(1,:),'o'); axis tight; title('Pressure')
    subplot(2,3,4); plot(x,z(1,:),'o'); axis tight; title('Fugacity')
    subplot(2,3,5); plot(x,t(1,:),'o'); axis tight; title('Temperature')
    subplot(2,3,6); plot(x,E(1,:),'o'); axis tight; title('Energy')
end
##### SOURCE END #####
--></body></html>
<a name="GaussHermite"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>GaussHermite</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="GaussHermite.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [x, w] = GaussHermite(n)

<span class="comment">% This function determines the abscisas (x) and weights (w) for the</span>
<span class="comment">% Gauss-Hermite quadrature of order n&gt;1, on the interval [-INF, +INF].</span>
    <span class="comment">% This function is valid for any degree n&gt;=2, as the companion matrix</span>
    <span class="comment">% (of the n'th degree Hermite polynomial) is constructed as a</span>
    <span class="comment">% symmetrical matrix, guaranteeing that all the eigenvalues (roots)</span>
    <span class="comment">% will be real.</span>


<span class="comment">% &iuml;&iquest;&frac12; Geert Van Damme</span>
<span class="comment">% geert@vandamme-iliano.be</span>
<span class="comment">% February 21, 2010</span>



<span class="comment">% Building the companion matrix CM</span>
    <span class="comment">% CM is such that det(xI-CM)=L_n(x), with L_n the Hermite polynomial</span>
    <span class="comment">% under consideration. Moreover, CM will be constructed in such a way</span>
    <span class="comment">% that it is symmetrical.</span>
i   = 1:n-1;
a   = sqrt(i/2);
CM  = diag(a,1) + diag(a,-1);

<span class="comment">% Determining the abscissas (x) and weights (w)</span>
    <span class="comment">% - since det(xI-CM)=L_n(x), the abscissas are the roots of the</span>
    <span class="comment">%   characteristic polynomial, i.d. the eigenvalues of CM;</span>
    <span class="comment">% - the weights can be derived from the corresponding eigenvectors.</span>
[V L]   = eig(CM);
[x ind] = sort(diag(L));
V       = V(:,ind)';
w       = sqrt(pi) * V(:,1).^2;
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="cotes_xw"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>cotes_xw</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="cotes_xw.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [x,w,k] = cotes_xw(a,b,N,nodes)

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%</span>
<span class="comment">% cotes.m</span>
<span class="comment">%</span>
<span class="comment">% 2 to 11 point Newton-Cotes nodes and weight values.</span>
<span class="comment">%</span>
<span class="comment">% Inputs:</span>
<span class="comment">%</span>
<span class="comment">% a - lower limit of integration</span>
<span class="comment">% b - upper limit of integration</span>
<span class="comment">% N - Requested number of grid points</span>
<span class="comment">% nodes - number of nodes in Newton-Cotes formula</span>
<span class="comment">%</span>
<span class="comment">% Sample Usage:</span>
<span class="comment">%</span>
<span class="comment">% &gt;&gt;[x,w,k]cotes_wx(0,pi/2,20,5)</span>
<span class="comment">%</span>
<span class="comment">% x : Nodes in x</span>
<span class="comment">% w : Weight constants</span>
<span class="comment">% k : Quadrature constant</span>
<span class="comment">%</span>
<span class="comment">% Written by: Manuel Diaz</span>
<span class="comment">% Based on http://mathworld.wolfram.com/Newton-CotesFormulas.html</span>
<span class="comment">%</span>
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

N = (nodes-1)*ceil(N/(nodes-1));  N1=N+1;
x = linspace(a,b,N1)';
h = x(2)-x(1);

<span class="keyword">switch</span> nodes

    <span class="keyword">case</span>{2} <span class="comment">% Trapezoidal Rule</span>
    w = kron(ones(1,N/1),[2])'; w(1)=1; w(N1)=1;
    k = 1/2*h;

    <span class="keyword">case</span>{3} <span class="comment">% Simpson's Rule</span>
    w = kron(ones(1,N/2),[2 4])'; w(1)=1; w(N1)=1;
    k = 1/3*h;

    <span class="keyword">case</span>{4} <span class="comment">% Simpson's 3/8 Rule</span>
    w = kron(ones(1,N/3),[2 3 3])'; w(1)=1; w(N1)=1;
    k = 3/8*h;

    <span class="keyword">case</span>{5} <span class="comment">% Boole's 4/90 Rule</span>
    w = kron(ones(1,N/4),[14 32 12 32])'; w(1)=7; w(N1)=7;
    k = 2/45*h;

    <span class="keyword">case</span>{6}
    w = kron(ones(1,N/5),[38 75 50 50 75])'; w(1)=19; w(N1)=19;
    k = 5/288*h;

    <span class="keyword">case</span>{7}
    w = kron(ones(1,N/6),[82 216 27 272 27 261])'; w(1)=41; w(N1)=41;
    k = 1/140*h;

    <span class="keyword">case</span>{8}
    w = kron(ones(1,N/7),[1502 3577 1323 2989 2989 1323 3577])';
    w(1)=751; w(N1)=751;
    k = 7/17280*h;

    <span class="keyword">case</span>{9}
    w = kron(ones(1,N/8),[1978 5888 -928 10496 -4540 10496 -928 5888])';
    w(1)=989; w(N1)=989;
    k = 4/14175*h;

    <span class="keyword">case</span>{10}
    w = kron(ones(1,N/9),[5714 15741 1080 19344 5778 <span class="keyword">...</span>
        5778 19344 1080 15741])';
    w(1)=2857; w(N1)=2857;
    k = 9/89600*h;

    <span class="keyword">case</span>{11}
    w = kron(ones(1,N/10),[32134 106300 48525 272400 260550 427368 <span class="keyword">...</span>
        260550 272400 48525 106300])';
    w(1)=16067; w(N1)=16067;
    k = 5/299367*h;

    <span class="keyword">otherwise</span>
        error(<span class="string">'Order must be between 2 and 11'</span>);
<span class="keyword">end</span>
<span class="keyword">return</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="ID_name"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ID_name</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="ID_name.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">ID name generator</a></li><li><a href="#3">Read Parameters</a></li><li><a href="#4">Generate ID</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [ID, IDn] = ID_name(name,theta,nx,P_deg,RK_stages,tau,IC_case,fmodel,f_case,method)
</pre><h2>ID name generator<a name="2"></a></h2><p>Generates ID and IDn for an specific simulation using the controling parameters.</p><h2>Read Parameters<a name="3"></a></h2><p>Name</p><pre class="codeinput">name1 = name(1:2);
name2 = name(3:end-1);
name3 = name(end-1:end);

<span class="comment">% Statistic Used</span>
<span class="keyword">switch</span> theta
    <span class="keyword">case</span> {-1}
        statistic = <span class="string">'BE'</span>;
    <span class="keyword">case</span> {0}
        statistic = <span class="string">'MB'</span>;
    <span class="keyword">case</span> {1}
        statistic = <span class="string">'FD'</span>;
    <span class="keyword">otherwise</span>
        error(<span class="string">'not a valid theta value'</span>)
<span class="keyword">end</span>
<span class="comment">% Model of the Equilibrium Distribution</span>
<span class="keyword">switch</span> fmodel
    <span class="keyword">case</span>{1} <span class="comment">%UU</span>
        feq = <span class="string">'-UU'</span>;
    <span class="keyword">case</span>{2} <span class="comment">%ES</span>
        feq = <span class="string">'-ES'</span>;
    <span class="keyword">otherwise</span>
        error(<span class="string">'Feq case not available'</span>)
<span class="keyword">end</span>
<span class="comment">% Method</span>
<span class="keyword">switch</span> method
    <span class="keyword">case</span>{1} <span class="comment">% Upwind</span>
        advec = <span class="string">'Upwind'</span>;
        P_degree = num2str(1);
    <span class="keyword">case</span>{2} <span class="comment">% TVD</span>
        advec = <span class="string">'TVD'</span>;
        P_degree = num2str(1);
    <span class="keyword">case</span>{3} <span class="comment">% WENO3</span>
        advec = <span class="string">'WENO3'</span>;
        P_degree = num2str(1);
    <span class="keyword">case</span>{4} <span class="comment">% WENO5</span>
        advec = <span class="string">'WENO5'</span>;
        P_degree = num2str(1);
    <span class="keyword">case</span>{5} <span class="comment">% DG</span>
        advec = <span class="string">'DGM'</span>;
        <span class="comment">% Polinomial Degree</span>
        P_degree = num2str(P_deg);
    <span class="keyword">otherwise</span>
        error(<span class="string">'Advection method not available'</span>)
<span class="keyword">end</span>

<span class="comment">% Elements used</span>
elements  = [<span class="string">'X'</span>,num2str(nx)];

<span class="comment">% RK stages</span>
RKs = num2str(RK_stages);

<span class="comment">% Initial Condition Number</span>
ic = num2str(IC_case);

<span class="comment">% Relaxation model or Euler limit</span>
<span class="keyword">switch</span> f_case
    <span class="keyword">case</span>{1} <span class="comment">% Relaxation time</span>
        <span class="comment">% Compute Relaxation frequency: 'omega',</span>
        omega = 1/tau;
        omega = [<span class="string">'w'</span>,num2str(omega)];
    <span class="keyword">case</span>{2} <span class="comment">% Euler Limit</span>
        omega = <span class="string">'EL'</span>;
    <span class="keyword">otherwise</span>
        error(<span class="string">'Feq case not available'</span>)
<span class="keyword">end</span>

<span class="comment">% Tecplot format</span>
f = <span class="string">'.plt'</span>;
</pre><h2>Generate ID<a name="4"></a></h2><pre class="codeinput">IDn = [name1,feq,name2,<span class="string">' '</span>,statistic,advec,name3,<span class="string">' '</span>,<span class="keyword">...</span>
    elements,<span class="string">'P'</span>,P_degree,<span class="string">'RK'</span>,RKs,<span class="string">' '</span>,omega,<span class="string">'IC'</span>,ic,f];
ID = [name1,feq,name2,<span class="string">'-'</span>,statistic,advec,name3,<span class="string">'-'</span>,<span class="keyword">...</span>
    elements,<span class="string">'P'</span>,P_degree,<span class="string">'RK'</span>,RKs,<span class="string">'-'</span>,omega,<span class="string">'IC'</span>,ic];
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="SSBGK_IC1d"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>SSBGK_IC1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="SSBGK_IC1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#3">Initial Physical Properties per case:</a></li><li><a href="#4">Load Selected case Initial condition:</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [r_0,u_0,t_0,p_0,rho_0,E_0,tEnd,cfl] = SSBGK_IC1d(x,input)
</pre><pre class="codeinput"><span class="comment">% Load the IC of a classical 2D Riemann Problem configuration.</span>
<span class="comment">% By Manuel Diaz 2012.10.24.</span>
<span class="comment">% In the notation we take advantage of the matlab array notation as follows</span>
<span class="comment">%</span>
<span class="comment">% prop = [prop_left , prop_right]</span>
<span class="comment">%</span>
<span class="comment">% Notation:</span>
<span class="comment">% u = Velocity in x direction</span>
<span class="comment">% p = Pressure</span>
<span class="comment">% rho = Density</span>
<span class="comment">% r = Fugacity</span>
<span class="comment">% E = Energy</span>
<span class="comment">% t = temperature</span>
<span class="comment">%</span>
<span class="comment">% Based on:</span>
<span class="comment">% http://wonka.physics.ncsu.edu/pub/VH-1/testpage/ and</span>
<span class="comment">% http://sitemaker.umich.edu/anand/files/riemann_shock-tube.pdf</span>
<span class="comment">% See also my routine CFD/Riemann.m to compute exact solutions.</span>
<span class="comment">%</span>
</pre><h2>Initial Physical Properties per case:<a name="3"></a></h2><pre class="codeinput"><span class="keyword">switch</span> input
    <span class="keyword">case</span>{1} <span class="comment">% Configuration 1, Sod's Problem</span>
        fprintf(<span class="string">'Case 1: Sods problem for DDOM\n'</span>);
        p   = [1.000 0.100];
        u   = [0.000 0.000];
        rho = [1.000 0.125];
        tEnd = 0.1; cfl = 0.15;

    <span class="keyword">case</span>{2} <span class="comment">% Configuration 2, Left Expansion and right strong shock</span>
        fprintf(<span class="string">'Case 2: Left Expansion and right strong shock \n'</span>);
        p   = [1000 0.1  ];
        u   = [0    0    ];
        rho = [3    2    ];
        tEnd = 0.02; cfl = 0.15;

    <span class="keyword">case</span>{3} <span class="comment">% Configuration 3, Right Expansion and left strong shock</span>
        fprintf(<span class="string">'Case 3: Right Expansion and left strong shock \n'</span>);
        p   = [7    10   ];
        u   = [0    0    ];
        rho = [1    1    ];
        tEnd = 0.1; cfl = 0.15;

    <span class="keyword">case</span>{4} <span class="comment">% Configuration 4, Double Shock</span>
        fprintf(<span class="string">'Case 4: Double Shock \n'</span>);
        p   = [450  45   ];
        u   = [20   -6   ];
        rho = [6    6    ];
        tEnd = 0.02; cfl = 0.15;

    <span class="keyword">case</span>{5} <span class="comment">% Configuration 5, Double Expansion</span>
        fprintf(<span class="string">'Case 5: Double Expansion \n'</span>);
        p   = [40   40   ];
        u   = [-2   2    ];
        rho = [1    2.5  ];
        tEnd = 0.03; cfl = 0.15;

    <span class="keyword">case</span>{6} <span class="comment">% Configuration 6, Cavitation</span>
        fprintf(<span class="string">'Case 6: Cavitation \n'</span>);
        p   = [0.4  0.4  ];
        u   = [-20  20   ];
        rho = [1    1    ];
        tEnd = 0.1; cfl = 0.15;

    <span class="keyword">case</span>{7} <span class="comment">% Shocktube problem of G.A. Sod, JCP 27:1, 1978</span>
        fprintf(<span class="string">'Shocktube problem of G.A. Sod, JCP 27:1, 1978 \n'</span>);
        p   = [1.0  0.1  ];
        u   = [0.75 0    ];
        rho = [1    0.125];
        tEnd = 0.10; cfl = 0.15;

    <span class="keyword">case</span>{8} <span class="comment">% Lax test case: M. Arora and P.L. Roe: JCP 132:3-11, 1997</span>
        fprintf(<span class="string">'Lax test case: M. Arora and P.L. Roe: JCP 132:3-11, 1997 \n'</span>);
        p   = [3.528 0.571];
        u   = [0.698 0    ];
        rho = [0.445 0.5  ];
        tEnd = 0.08; cfl = 0.15;

    <span class="keyword">case</span>{9} <span class="comment">% Mach = 3 test case: M. Arora and P.L. Roe: JCP 132:3-11, 1997</span>
        fprintf(<span class="string">'Mach = 3 test case: M. Arora and P.L. Roe: JCP 132:3-11, 1997 \n'</span>);
        p   = [10.333  1  ];
        u   = [ 0.92  3.55];
        rho = [ 3.857  1  ];
        tEnd = 0.09; cfl = 0.15;

    <span class="keyword">case</span>{10} <span class="comment">% Shocktube problem with supersonic zone</span>
        fprintf(<span class="string">'Shocktube problem with supersonic zone \n'</span>);
        p   = [1  0.02];
        u   = [0  0.00];
        rho = [1  0.02];
        tEnd = 0.162; cfl = 0.15;

    <span class="keyword">case</span>{11} <span class="comment">% Contact discontinuity</span>
        fprintf(<span class="string">'Contact discontinuity \n'</span>);
        p   = [0.5 0.5];
        u   = [0.0 0.0];
        rho = [1.0 0.6];
        tEnd = 1; cfl = 0.15;

    <span class="keyword">case</span>{12} <span class="comment">% Stationary shock</span>
        fprintf(<span class="string">'Stationary shock \n'</span>);
        p   = [ 1.0  0.1 ];
        u   = [-2.0 -2.0 ];
        rho = [ 1.0 0.125];
        tEnd = 0.1; cfl = 0.15;

	<span class="keyword">case</span>{13} <span class="comment">% Bogus case 1, Unknown</span>
        fprintf(<span class="string">'Case 7: Bogus case 1, Unknown \n'</span>);
        u  = [0         0        ];
        t  = [4.38385   8.972544 ];
        r  = [0.2253353 0.1204582];
        tEnd = 0.1; cfl = 0.15;

    <span class="keyword">case</span>{14} <span class="comment">% Manuel's Blastwave</span>
        fprintf(<span class="string">'Manuel`s Blastwave, IAM 2013 \n'</span>);
        p   = [4.00 0.10 1.00];
        u   = [1.00 0.00 -1.0];
        rho = [0.90 0.90 0.90];
        tEnd = 0.20; cfl = 0.15;

    <span class="keyword">otherwise</span>
        error(<span class="string">'Available cases: 1~13'</span>);

<span class="keyword">end</span>
<span class="comment">% Compute Semiclassical ICs</span>
<span class="keyword">if</span> input ~= 13
    E = p+(0.5).*rho.*u.^2; <span class="comment">% Energy</span>
    t = 4*E./rho-2*u.^2;    <span class="comment">% Temperature</span>
    r = rho./sqrt(pi*t);    <span class="comment">% Fugacity</span>
<span class="keyword">else</span>
    <span class="comment">% Do nothing</span>
<span class="keyword">end</span>
</pre><h2>Load Selected case Initial condition:<a name="4"></a></h2><p>number of points required</p><pre class="codeinput"> [k,nx] = size(x);

 <span class="keyword">switch</span> input
     <span class="keyword">case</span>{1,2,3,4,5,6,7,8,9,10,11,12,13} <span class="comment">% L and R IC's</span>
         <span class="comment">% Preallocating</span>
         r_0 = zeros(k,nx); u_0 = zeros(k,nx); t_0 = zeros(k,nx);
         p_0 = zeros(k,nx); rho_0 = zeros(k,nx); E_0 = zeros(k,nx);
         <span class="comment">% Parameters of regions dimensions</span>
         x_middle = (x(end)-x(1))/2;
         L = find(x&lt;=x_middle);
         R = find(x&gt;x_middle);

         <span class="comment">% Initial Condition for our 2D domain</span>
         <span class="comment">% Fugacity</span>
         r_0(L) = r(1); <span class="comment">% region 1</span>
         r_0(R) = r(2); <span class="comment">% region 2</span>
         <span class="comment">% Velovity in x</span>
         u_0(L) = u(1); <span class="comment">% region 1</span>
         u_0(R) = u(2); <span class="comment">% region 2</span>
         <span class="comment">% temperature</span>
         t_0(L) = t(1); <span class="comment">% region 1</span>
         t_0(R) = t(2); <span class="comment">% region 2</span>
         <span class="comment">% pressure</span>
         p_0(L) = p(1); <span class="comment">% region 1</span>
         p_0(R) = p(2); <span class="comment">% region 2</span>
         <span class="comment">% density</span>
         rho_0(L) = rho(1); <span class="comment">% region 1</span>
         rho_0(R) = rho(2); <span class="comment">% region 2</span>
         <span class="comment">% Energy</span>
         E_0(L) = E(1); <span class="comment">% region 1</span>
         E_0(R) = E(2); <span class="comment">% region 2</span>

     <span class="keyword">case</span>{14} <span class="comment">% 3-zones IC's</span>
         <span class="comment">% Preallocating</span>
         r_0 = zeros(k,nx); u_0 = zeros(k,nx); t_0 = zeros(k,nx);
         p_0 = zeros(k,nx); rho_0 = zeros(k,nx); E_0 = zeros(k,nx);
         <span class="comment">% Parameters of regions dimensions</span>
         L = abs(x(end)-x(1));
         x_a = x(1); x_b = 0.3*L; x_c = 0.7*L; x_d = x(end);
         L = find(x&gt;=x_a &amp; x&lt;=x_b);
         C = find(x&gt; x_b &amp; x&lt;=x_c);
         R = find(x&gt; x_c &amp; x&lt;=x_d);

         <span class="comment">% Initial Condition for our 2D domain</span>
         <span class="comment">% Fugacity</span>
         r_0(L) = r(1); <span class="comment">% region 1</span>
         r_0(C) = r(2); <span class="comment">% region 2</span>
         r_0(R) = r(3); <span class="comment">% region 2</span>
         <span class="comment">% Velovity in x</span>
         u_0(L) = u(1); <span class="comment">% region 1</span>
         u_0(C) = u(2); <span class="comment">% region 2</span>
         u_0(R) = u(3); <span class="comment">% region 2</span>
         <span class="comment">% temperature</span>
         t_0(L) = t(1); <span class="comment">% region 1</span>
         t_0(C) = t(2); <span class="comment">% region 2</span>
         t_0(R) = t(3); <span class="comment">% region 2</span>
         <span class="comment">% pressure</span>
         p_0(L) = p(1); <span class="comment">% region 1</span>
         p_0(C) = p(2); <span class="comment">% region 2</span>
         p_0(R) = p(3); <span class="comment">% region 2</span>
         <span class="comment">% density</span>
         rho_0(L) = rho(1); <span class="comment">% region 1</span>
         rho_0(C) = rho(2); <span class="comment">% region 2</span>
         rho_0(R) = rho(3); <span class="comment">% region 2</span>
         <span class="comment">% Energy</span>
         E_0(L) = E(1); <span class="comment">% region 1</span>
         E_0(C) = E(2); <span class="comment">% region 2</span>
         E_0(R) = E(3); <span class="comment">% region 2</span>
 <span class="keyword">end</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="apply_DOM"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>apply_DOM</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="apply_DOM.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [a,b,c] = apply_DOM(a,b,c,nv)
<span class="comment">% Repeat arrays 'nv' times</span>
    a = repmat(a,nv,1);     c = repmat(c,nv,1);
    b = repmat(b,nv,1);
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="f_ES_equilibrium_1d"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>f_ES_equilibrium_1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="f_ES_equilibrium_1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> f = f_ES_equilibrium_1d(z,p,n,u,c,t,theta)
<span class="comment">% Compute equilibrum in 1d cases for:</span>
<span class="comment">%</span>
<span class="comment">% MB:  Maxwell-Boltzmann, theta =  0</span>
<span class="comment">% FD:  Fermi-Diract,      theta = +1</span>
<span class="comment">% BE:  Bose-Einstein,     theta = -1</span>
<span class="comment">%</span>
<span class="comment">% inputs:</span>
<span class="comment">% u: macroscopic velocity</span>
<span class="comment">% x: microscopic velocity</span>
<span class="comment">% t: temperature</span>
<span class="comment">% r: fugacity</span>
<span class="comment">% p: pressure</span>
<span class="comment">% n: density</span>

f = 1./(exp( (c-u).^2 ./ t)./z + theta);
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="f_equilibrium_1d"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>f_equilibrium_1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="f_equilibrium_1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> f = f_equilibrium_1d(z,u,c,t,theta)
<span class="comment">% Compute equilibrum in 1d cases for:</span>
<span class="comment">%</span>
<span class="comment">% MB:  Maxwell-Boltzmann, theta =  0</span>
<span class="comment">% FD:  Fermi-Diract,      theta = +1</span>
<span class="comment">% BE:  Bose-Einstein,     theta = -1</span>
<span class="comment">%</span>
<span class="comment">% Inputs:</span>
<span class="comment">% u: macroscopic velocity</span>
<span class="comment">% x: microscopic velocity</span>
<span class="comment">% t: temperature</span>
<span class="comment">% z: fugacity</span>

f = 1./(exp( (c-u).^2 ./ t)./z + theta);
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="macromoments1d"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>macromoments1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="macromoments1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Compute Macroscopic Moments</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [n, nux, nE ,ne , Wxx] = macromoments1d(k,w,f,v,ux)
</pre><h2>Compute Macroscopic Moments<a name="2"></a></h2><pre class="codeinput"><span class="comment">% For any finite difference method (FDM), we use normal sum().</span>
<span class="comment">% Using Quadrature rules to integrate for:</span>
     n   = k*sum(w .* f );    <span class="comment">% Density [n]</span>
     nux = k*sum(v .* w .* f );   <span class="comment">% momentum in x [n*ux]</span>
     nE   = k*sum(0.5*( v.^2 ).* w .* f ); <span class="comment">% Total Energy [n*E]</span>

	 <span class="comment">%ux = nux/n; &lt;-- Carefull! must use 'ux' from the last time step!</span>
	 ne  = 0.5*k*sum(( (v-ux).^2 ).* w .* f); <span class="comment">% Internal Energy [n*e]</span>
     Wxx = k*sum(w .* f .*(v-ux).^2 ); <span class="comment">% Pressure tensor component xx</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="macroproperties1d"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>macroproperties1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="macroproperties1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Recover Macroscopic Properties</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [r,u,t,p] = macroproperties1d(n,nux,E,ne,Wxx,nx,theta,fmodel)
</pre><h2>Recover Macroscopic Properties<a name="2"></a></h2><p>compute back, fugacity, macroscopic velocities, temperature and pressure. Computing first velocites from the momentum:</p><pre class="codeinput">    u = nux./n; <span class="comment">% mean velocity in x</span>
    <span class="comment">%e = ne./n;  % internal energy</span>

<span class="comment">% to compute fugacity, temperature and pressure, we need to rely on the</span>
<span class="comment">% distribution fucntion that we where are using: MB, FD, BE.</span>
<span class="keyword">switch</span> theta
    <span class="keyword">case</span>{-1} <span class="comment">% BE</span>
        r = zeros(1,nx);
        t = zeros(1,nx);
        p = zeros(1,nx);
    <span class="comment">% If BE: we apply bisection method to the approx BE distribution Eq.</span>
        r_a = 0.001; r_b = 0.99; tol = 1e-7;
        <span class="keyword">for</span> i = 1:nx
            <span class="keyword">if</span> fmodel == 1 <span class="comment">% UU Model</span>
            psi = @(r_x) 2*E(i)- <span class="keyword">...</span>
                BE(r_x,1.5)*(n(i)/BE(r_x,0.5))^3/(2*pi) - n(i)*(u(i)^2);
            <span class="keyword">else</span> <span class="comment">% == 2, ES Model</span>
            psi = @(r_x) 2*pi*Wxx(i)/n(i)^3 - BE(r_x,1.5)/(BE(r_x,0.5))^3;
            <span class="keyword">end</span>
            r_p = bisection(psi,r_a,r_b,tol);
            r(i) = r_p;
            t(i) = n(i)^2/(pi*(BE(r_p,0.5))^2);
            p(i) = E(i) - 1/2*n(i)*(u(i)^2);
        <span class="keyword">end</span>

    <span class="keyword">case</span>{1} <span class="comment">% FD</span>
        r = zeros(1,nx);
        t = zeros(1,nx);
        p = zeros(1,nx);
    <span class="comment">% if FD: we apply bisection method to the approx FD distribution Eq.</span>
        r_a = 0.001; r_b = 0.99; tol = 1e-7;
        <span class="keyword">for</span> i = 1:nx
            <span class="keyword">if</span> fmodel == 1 <span class="comment">% UU Model</span>
            psi = @(r_x) 2*E(i)- <span class="keyword">...</span>
                FD(r_x,1.5)*(n(i)/FD(r_x,0.5))^3/(2*pi) - n(i)*(u(i)^2);
            <span class="keyword">else</span> <span class="comment">% == 2, ES Model</span>
            psi = @(r_x) 2*pi*Wxx(i)/n(i)^3 - FD(r_x,1.5)/(FD(r_x,0.5))^3;
            <span class="keyword">end</span>
            r_p = bisection(psi,r_a,r_b,tol);
            r(i) = r_p;
            t(i) = n(i)^2/(pi*(FD(r_p,0.5))^2);
            p(i) = E(i) - 1/2*n(i)*(u(i)^2);
        <span class="keyword">end</span>

    <span class="keyword">case</span>{0} <span class="comment">% MB</span>
    <span class="comment">% IF MB: the task is much simple.</span>
        t = 4*E./n - 2*u.^2;
        r = n./sqrt(pi.*t);
        p = ne;

        <span class="comment">%t = 4*E./n - 2*u.^2;</span>
        <span class="comment">%r = n./sqrt(pi.*t);</span>
        <span class="comment">%p = E - 1/2.*n.*u.^2;</span>

    <span class="keyword">otherwise</span>
        error(<span class="string">'theta can only be: -1, 0, +1 '</span>);
<span class="keyword">end</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="TVDflux1d"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>TVDflux1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="TVDflux1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Grid Size</a></li><li><a href="#3">Test a</a></li><li><a href="#4">Compute TVD fluxes</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [f_s,f_r] = TVDflux1d(u,a,dtdx,phi_x)
</pre><h2>Grid Size<a name="2"></a></h2><pre class="codeinput">nx=length(u);
x = 2:nx-1;
</pre><h2>Test a<a name="3"></a></h2><p>Check whether a and b are scalar velocities or prescribed velocities in the entire domain</p><pre class="codeinput">[m,n,r] = size(a);
<span class="keyword">if</span> m == 1 &amp;&amp; n == 1 &amp;&amp; r == 1
    a = a*ones(1,nx); <span class="comment">% map the x-velocity</span>
<span class="keyword">else</span>
    <span class="comment">%do nothing</span>
<span class="keyword">end</span>
clear <span class="string">m</span> <span class="string">n</span> <span class="string">r</span>;

<span class="comment">% Compute Flux Spliting Factors</span>
a_p = max(a,0); <span class="comment">% a{+}</span>
a_m = min(a,0); <span class="comment">% a{-}</span>
</pre><h2>Compute TVD fluxes<a name="4"></a></h2><p>Note: s = Left flux &amp; r = Right flux l = low flux  &amp; h = high flux</p><pre class="codeinput"><span class="comment">% Initalize Arrays</span>
fsl = zeros(1,nx); fsh = zeros(1,nx); f_s = zeros(1,nx);
frl = zeros(1,nx); frh = zeros(1,nx); f_r = zeros(1,nx);

<span class="keyword">for</span> j = x
    <span class="comment">% Compute fluxes for TVD</span>
    frl(j) = a_p(j)*u(j) + a_m(j)*u(j+1);
    frh(j) = (1/2)*a(j)*(u(j)+u(j+1)) - (1/2)*(a(j)^2)*dtdx*(u(j+1)-u(j));
    f_r(j) = frl(j) + phi_x(j)*( frh(j) - frl(j) );

    fsl(j) = a_p(j)*u(j-1) + a_m(j)*u(j);
    fsh(j) = (1/2)*a(j)*(u(j-1)+u(j)) - (1/2)*(a(j)^2)*dtdx*(u(j)-u(j-1));
    f_s(j)  = fsl(j) + phi_x(j-1)*( fsh(j) - fsl(j) );
<span class="keyword">end</span>

<span class="keyword">return</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="Upwindflux1d"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Upwindflux1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="Upwindflux1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Grid Size</a></li><li><a href="#3">Test a</a></li><li><a href="#4">Compute TVD fluxes</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [f_s,f_r] = Upwindflux1d(u,a)
</pre><h2>Grid Size<a name="2"></a></h2><pre class="codeinput">nx=length(u);
x = 2:nx-1;
</pre><h2>Test a<a name="3"></a></h2><p>Check whether a and b are scalar velocities or prescribed velocities in the entire domain</p><pre class="codeinput">[m,n,r] = size(a);
<span class="keyword">if</span> m == 1 &amp;&amp; n == 1 &amp;&amp; r == 1
    a = a*ones(1,nx); <span class="comment">% map the x-velocity</span>
<span class="keyword">else</span>
    <span class="comment">%do nothing</span>
<span class="keyword">end</span>
clear <span class="string">m</span> <span class="string">n</span> <span class="string">r</span>;

<span class="comment">% Compute Flux Spliting Factors</span>
a_p = max(a,0); <span class="comment">% a{+}</span>
a_m = min(a,0); <span class="comment">% a{-}</span>
</pre><h2>Compute TVD fluxes<a name="4"></a></h2><p>Note: s = Left flux &amp; r = Right flux l = low flux  &amp; h = high flux</p><pre class="codeinput"><span class="comment">% Initalize Arrays</span>
f_s = zeros(1,nx); <span class="comment">%fsl = zeros(1,nx); fsh = zeros(1,nx);</span>
f_r = zeros(1,nx); <span class="comment">%frl = zeros(1,nx); frh = zeros(1,nx);</span>

<span class="keyword">for</span> j = x
    <span class="comment">% Compute fluxes for TVD</span>
    f_r(j) = a_p(j)*u(j) + a_m(j)*u(j+1);
    f_s(j) = a_p(j)*u(j-1) + a_m(j)*u(j);
<span class="keyword">end</span>

<span class="keyword">return</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="fluxlimiter1d"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>fluxlimiter1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="fluxlimiter1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Compute by case:</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> phi_x = fluxlimiter1d(r_x,limiter)
</pre><h2>Compute by case:<a name="2"></a></h2><pre class="codeinput"><span class="keyword">switch</span> limiter
    <span class="keyword">case</span>{1} <span class="comment">% Van Leer</span>
        <span class="comment">%fprintf('\n using Van Leer Limiter \n\n');</span>
        phi_x = (r_x + abs(r_x))./(1 + abs(r_x));

    <span class="keyword">case</span>{2} <span class="comment">% Superbee</span>
        <span class="comment">%fprintf('\n using Superbee Limiter \n\n');</span>
        <span class="comment">%phi = max(0,min(2.*r,0),min(r,2));</span>
        phi_x_star = max(min(2.*r_x,0),min(r_x,2));
        phi_x = max(0,phi_x_star);

    <span class="keyword">case</span>{3} <span class="comment">% Minmod</span>
        <span class="comment">%fprintf('\n using Minmod Limiter \n\n');</span>
        phi_x = max(0,min(1,r_x));

    <span class="keyword">case</span>{4} <span class="comment">% koren</span>
        <span class="comment">%fprintf('\n using Koren Limiter \n\n');</span>
         <span class="comment">%phi = max(0,min(2*r,(2/3)*r+1/3,2));</span>
        phi_x_star = min(2*r_x,(2/3)*r_x+1/3);
        phi_x_hat  = min(phi_x_star,2);
        phi_x = max(0,phi_x_hat);

    <span class="keyword">otherwise</span>
        error(<span class="string">'only supported 1,2,3 and 4'</span>);
<span class="keyword">end</span>

<span class="keyword">return</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="theta1d"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>theta1d</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="theta1d.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Theta: smooth measuring factor (r_x)</a></li><li><a href="#3">Compute r_x</a></li><li><a href="#4">Test a</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [r_x] = theta1d(u,a)
</pre><h2>Theta: smooth measuring factor (r_x)<a name="2"></a></h2><p>INPUTS u: Vector domain, u(j) a: x-velocity in our domain, a(j)</p><h2>Compute r_x<a name="3"></a></h2><p>Initialize variables</p><pre class="codeinput">nx  = length(u);
r_x = zeros(1,nx);
</pre><h2>Test a<a name="4"></a></h2><p>Check whether a is scalar or a vector of velocities with prescribed velocities in the entire domain</p><pre class="codeinput">[m,n,r] = size(a);
<span class="keyword">if</span> m == 1 &amp;&amp; n == 1 &amp;&amp; r == 1
    a = a*ones(1,nx); <span class="comment">% map the x-velocity</span>
<span class="keyword">else</span>
    <span class="comment">%do nothing</span>
<span class="keyword">end</span>

<span class="comment">% Main loop</span>
x = 2:nx-1;
<span class="keyword">for</span> j = x
    <span class="comment">% smooth measurement factor 'r_x'</span>
    <span class="keyword">if</span> u(j) == u(j+1)
        r_x(j) = 1;
    <span class="keyword">elseif</span> a(j) &gt; 0
        r_x(j) = (u(j) - u(j-1)) / (u(j+1) - u(j));
    <span class="keyword">elseif</span> a(j) &lt; 0
        u(nx+1) = u(nx); <span class="comment">% we will need an extra column value</span>
        r_x(j) = (u(j+2) - u(j+1)) / (u(j+1) - u(j));
    <span class="keyword">end</span>
<span class="keyword">end</span>
r_x(1) = 1; r_x(nx) = 1;

<span class="keyword">return</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="WENO3_1d_BCs"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>WENO3_1d_BCs</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="WENO3_1d_BCs.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> u_next = WENO3_1d_BCs(u_next,bc_type,nx)
<span class="comment">% Compute boundary conditions for WENO3 in 1D Domain</span>

<span class="keyword">switch</span> bc_type
    <span class="keyword">case</span>{1} <span class="comment">% Dirichlet BC</span>
        fix_a = 1.0;
        fix_b = 0.0;
        u_next(1)    = fix_a; <span class="comment">% left boundary condition (fixed value)</span>
        u_next(2)    = fix_a; <span class="comment">% left boundary condition (fixed value)</span>
        u_next(3)    = fix_a; <span class="comment">% left boundary condition (fixed value)</span>
        u_next(nx-2) = fix_b; <span class="comment">% right boundary condition (fixed value)</span>
        u_next(nx-1) = fix_b; <span class="comment">% right boundary condition (fixed value)</span>
        u_next( nx ) = fix_b; <span class="comment">% right boundary condition (fixed value)</span>

    <span class="keyword">case</span>{2} <span class="comment">% Neumann BC</span>
        u_next(nx-2) = u_next(nx-3); <span class="comment">% right boundary condition</span>
        u_next(nx-1) = u_next(nx-3); <span class="comment">% right boundary condition</span>
        u_next( nx ) = u_next(nx-3); <span class="comment">% right boundary condition</span>
        u_next(3)    = u_next(4);    <span class="comment">% left boundary condition</span>
        u_next(2)    = u_next(4);    <span class="comment">% left boundary condition</span>
        u_next(1)    = u_next(4);    <span class="comment">% left boundary condition</span>

    <span class="keyword">case</span>{3} <span class="comment">% Periodic BC</span>
        u_next(nx-2) = u_next(4);    <span class="comment">% right boundary condition</span>
        u_next(nx-1) = u_next(5);    <span class="comment">% right boundary condition</span>
        u_next( nx ) = u_next(6);    <span class="comment">% right boundary condition</span>
        u_next(1)    = u_next(nx-5); <span class="comment">% left boundary condition</span>
        u_next(2)    = u_next(nx-4); <span class="comment">% left boundary condition</span>
        u_next(3)    = u_next(nx-3); <span class="comment">% left boundary condition</span>
<span class="comment">%    case{4} % Reflective BC</span>

    <span class="keyword">otherwise</span>
        error(<span class="string">'case not available'</span>)
<span class="keyword">end</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="WENO3_1d_driver"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>WENO3_1d_driver</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="WENO3_1d_driver.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [h_left,h_right] = WENO3_1d_driver(vp,vn)
<span class="comment">% WENO3 Reconstruction Driver</span>

<span class="comment">% Number of cells</span>
nx = length(vp);

<span class="comment">% Allocate variables</span>
hn = zeros(size(vn));
hp = zeros(size(vp));

<span class="comment">% Reconstruc h+ and h- fluxes</span>
<span class="keyword">for</span> i = 3:nx-2
    xr = i-2:i+2;   <span class="comment">% x-range of cells</span>
    [hn(i),hp(i-1)] = WENO3_1d_flux(vp(xr),vn(xr));
<span class="keyword">end</span>
h = sum([hn;hp]);

<span class="comment">% Formulate Left and Right fluxes, equiv: %h(i) - h(i-1)</span>
h_right = [h(1:end-2),0,0];
h_left = [0,0,h(2:end-1)];
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="WENO5_1d_driver"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>WENO5_1d_driver</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="WENO5_1d_driver.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [h_left,h_right] = WENO5_1d_driver(vp,vn)
<span class="comment">% WENO3 Reconstruction Driver</span>

<span class="comment">% Number of cells</span>
nx = length(vp);

<span class="comment">% Allocate variables</span>
hn = zeros(size(vn));
hp = zeros(size(vp));

<span class="comment">% Reconstruc h+ and h- fluxes</span>
<span class="keyword">for</span> i = 4:nx-3
    xr = i-3:i+3;   <span class="comment">% x-range of cells</span>
    [hn(i),hp(i-1)] = WENO5_1d_flux(vp(xr),vn(xr));
<span class="keyword">end</span>
h = sum([hn;hp]);

<span class="comment">% Formulate Left and Right fluxes, equiv: %h(i) - h(i-1)</span>
h_right = [h(1:end-3),0,0,0];
h_left = [0,0,0,h(3:end-1)];
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
<a name="WENO_scalarfluxsplit"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>WENO_scalarfluxsplit</title><meta name="generator" content="MATLAB 7.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2013-03-20"><meta name="DC.source" content="WENO_scalarfluxsplit.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }

  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [vp,vn] = WENO_scalarfluxsplit(v)
<span class="comment">% WENO flux spliting subroutine.</span>
<span class="comment">% OUTPUT:</span>
<span class="comment">% * vp: positive flux, v^{+}, which is intended for reconstructing f_{i+1/2}^{-}</span>
<span class="comment">% * vn: negative flux  v^{-}, which in intended for reconstructing f_{i+1/2}^{+}</span>

<span class="comment">% Godunov Flux Spliting</span>
vp = 0.5*(v + abs(v)); <span class="comment">%flux^{+}</span>
vn = 0.5*(v - abs(v)); <span class="comment">%flux^{-}</span>
</pre><p class="footer"><br>
      Published with MATLAB&reg; 7.14<br></p></div><!--
\n
--></body></html>
